#!/bin/sh

output_dir=$1
variants=

for v6 in 0 1; do
for mss in 536 1460; do
for feat in 0 1; do

if [ $v6 = 1 ] && [ $feat = 0 ] ; then
    continue
fi

variant=lwip$((2+4*$v6))
variant+=-$mss
if [ $feat = 1 ] ; then
    variant+=-feat
fi

mkdir -p $output_dir/$variant/
cat << EOF > $output_dir/$variant/CMakeLists.txt
# generated by scripts/cmake-generate
cmake_minimum_required(VERSION 3.9)
project($variant LANGUAGES C)

set(TCP_MSS $mss)
set(LWIP_IPV6 $v6)
set(LWIP_FEATURES $feat)

include(lwip-builder.cmake)
EOF

variants+="$variant "

done
done
done

echo $variants
